Goal:
parse netlist
build node index map (excluding ground)
initialize G matrix and I vector
for each element:
    if resistor → stamp conductance into G
    if current source → stamp into I
return G, I

# Parse Netlist
elements = []

for each line in netlist:
    if line is empty or starts with '*':
        continue

    tokens = split(line)
    name = tokens[0]
    n1 = tokens[1]
    n2 = tokens[2]
    value = parse_value(tokens[3])   // handles k, m, etc.

    elements.append({name, n1, n2, value})

# Build Node Index Map
node_set = empty set

for each element in elements:
    if element.n1 != "0":
        add element.n1 to node_set
    if element.n2 != "0":
        add element.n2 to node_set

node_list = sorted(node_set)

node_index = empty map
index = 0
for node in node_list:
    node_index[node] = index
    index += 1

N = number of nodes
# Initialize Matrices
G = zero matrix of size N x N
I = zero vector of size N
# Stamp elements
## Stamp Resistors
function stamp_resistor(n1, n2, R):
    g = 1 / R

    if n1 != "0":
        i = node_index[n1]
        G[i][i] += g

    if n2 != "0":
        j = node_index[n2]
        G[j][j] += g

    if n1 != "0" and n2 != "0":
        i = node_index[n1]
        j = node_index[n2]
        G[i][j] -= g
        G[j][i] -= g
## Current Source Stamp
function stamp_current_source(n1, n2, Ival):
    if n1 != "0":
        i = node_index[n1]
        I[i] -= Ival

    if n2 != "0":
        j = node_index[n2]
        I[j] += Ival
# Main stamping loop
for each element in elements:
    if element.name starts with "R":
        stamp_resistor(element.n1, element.n2, element.value)

    else if element.name starts with "I":
        stamp_current_source(element.n1, element.n2, element.value)
# Output
return G, I

